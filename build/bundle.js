var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function i(e){e.forEach(t)}function l(e){return"function"==typeof e}function o(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function r(e,t){e.appendChild(t)}function a(e,t,n){e.insertBefore(t,n||null)}function s(e){e.parentNode.removeChild(e)}function c(e){return document.createElement(e)}function h(e){return document.createTextNode(e)}function u(){return h(" ")}function d(e,t,n,i){return e.addEventListener(t,n,i),()=>e.removeEventListener(t,n,i)}function p(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function m(e,t){t=""+t,e.data!==t&&(e.data=t)}let w;function f(e){w=e}function g(e){(function(){if(!w)throw new Error("Function called outside component initialization");return w})().$$.on_mount.push(e)}const y=[],b=[],v=[],L=[],R=Promise.resolve();let $=!1;function k(e){v.push(e)}let U=!1;const C=new Set;function x(){if(!U){U=!0;do{for(let e=0;e<y.length;e+=1){const t=y[e];f(t),T(t.$$)}for(y.length=0;b.length;)b.pop()();for(let e=0;e<v.length;e+=1){const t=v[e];C.has(t)||(C.add(t),t())}v.length=0}while(y.length);for(;L.length;)L.pop()();$=!1,U=!1,C.clear()}}function T(e){if(null!==e.fragment){e.update(),i(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(k)}}const M=new Set;let H;function W(e,t){e&&e.i&&(M.delete(e),e.i(t))}function _(e,t,n,i){if(e&&e.o){if(M.has(e))return;M.add(e),H.c.push(()=>{M.delete(e),i&&(n&&e.d(1),i())}),e.o(t)}}function P(e){e&&e.c()}function S(e,n,o){const{fragment:r,on_mount:a,on_destroy:s,after_update:c}=e.$$;r&&r.m(n,o),k(()=>{const n=a.map(t).filter(l);s?s.push(...n):i(n),e.$$.on_mount=[]}),c.forEach(k)}function G(e,t){const n=e.$$;null!==n.fragment&&(i(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function z(e,t){-1===e.$$.dirty[0]&&(y.push(e),$||($=!0,R.then(x)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function I(t,l,o,r,a,c,h=[-1]){const u=w;f(t);const d=l.props||{},p=t.$$={fragment:null,ctx:null,props:c,update:e,not_equal:a,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:[]),callbacks:n(),dirty:h};let m=!1;if(p.ctx=o?o(t,d,(e,n,...i)=>{const l=i.length?i[0]:n;return p.ctx&&a(p.ctx[e],p.ctx[e]=l)&&(p.bound[e]&&p.bound[e](l),m&&z(t,e)),n}):[],p.update(),m=!0,i(p.before_update),p.fragment=!!r&&r(p.ctx),l.target){if(l.hydrate){const e=function(e){return Array.from(e.childNodes)}(l.target);p.fragment&&p.fragment.l(e),e.forEach(s)}else p.fragment&&p.fragment.c();l.intro&&W(t.$$.fragment),S(t,l.target,l.anchor),x()}f(u)}class A{$destroy(){G(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(){}}function O(t){let n,i,l,o,d,w,f,g,y,b,v,L,R,$,k,U,C,x;return{c(){n=c("main"),i=c("h1"),l=h(t[0]),o=u(),d=c("h4"),d.innerHTML='\n    Building a game in\n    <a href="https://flutter.dev/">#flutter</a>\n    without any libraries or frameworks\n  ',w=u(),f=c("iframe"),y=u(),b=c("p"),v=c("a"),L=h("Follow on Twitch"),R=h("\n    |\n    "),$=c("a"),k=h("Subscribe on YouTube"),U=h("\n    |\n    "),C=c("a"),x=h("Follow on Twitter"),p(f,"title","YouTube"),p(f,"class","center"),p(f,"width",t[5]),p(f,"height",t[6]),f.src!==(g=t[1])&&p(f,"src",g),p(f,"frameborder","0"),p(f,"allow","accelerometer; autoplay; encrypted-media; gyroscope;\n    picture-in-picture"),f.allowFullscreen=!0,p(v,"href",t[3]),p(v,"target","_blank"),p($,"href",t[2]),p($,"target","_blank"),p(C,"href",t[4]),p(C,"target","_blank")},m(e,t){a(e,n,t),r(n,i),r(i,l),r(n,o),r(n,d),r(n,w),r(n,f),r(n,y),r(n,b),r(b,v),r(v,L),r(b,R),r(b,$),r($,k),r(b,U),r(b,C),r(C,x)},p(e,[t]){1&t&&m(l,e[0]),32&t&&p(f,"width",e[5]),64&t&&p(f,"height",e[6]),2&t&&f.src!==(g=e[1])&&p(f,"src",g),8&t&&p(v,"href",e[3]),4&t&&p($,"href",e[2]),16&t&&p(C,"href",e[4])},i:e,o:e,d(e){e&&s(n)}}}function E(e,t,n){let i,l,{title:o}=t,{embedPlaylist:r}=t,{subChannelURL:a}=t,{twitchChannelURL:s}=t,{twitterURL:c}=t,{windowWidth:h}=t;return e.$set=e=>{"title"in e&&n(0,o=e.title),"embedPlaylist"in e&&n(1,r=e.embedPlaylist),"subChannelURL"in e&&n(2,a=e.subChannelURL),"twitchChannelURL"in e&&n(3,s=e.twitchChannelURL),"twitterURL"in e&&n(4,c=e.twitterURL),"windowWidth"in e&&n(7,h=e.windowWidth)},e.$$.update=()=>{128&e.$$.dirty&&n(5,i=Math.min(.66*h,560)),32&e.$$.dirty&&n(6,l=i/1.77)},[o,r,a,s,c,i,l,h]}class F extends A{constructor(e){super(),I(this,e,E,O,o,{title:0,embedPlaylist:1,subChannelURL:2,twitchChannelURL:3,twitterURL:4,windowWidth:7})}}function q(t){let n,i,l,o,d,w,f,g,y,b,v,L,R,$,k,U,C,x,T,M,H;return{c(){n=c("main"),i=c("h1"),l=h(t[1]),o=u(),d=c("p"),w=h("Get the\n    "),f=c("a"),g=h("Latest Release"),y=u(),b=c("span"),b.textContent="with sound effects and a beautiful universe!",v=u(),L=c("p"),L.textContent="You can also try the web version below.",R=u(),$=c("p"),$.textContent="However keep in mind that the performance of the native apps is far\n    superior.",k=u(),U=c("iframe"),x=u(),T=c("p"),M=c("a"),H=h("Source on Github"),p(f,"class","release-link svelte-bcu0ri"),p(f,"href",t[3]),p(f,"target","_blank"),p(b,"class","italic svelte-bcu0ri"),p(U,"title","game"),p(U,"class","center"),p(U,"width",t[5]),p(U,"height",t[6]),U.src!==(C=t[2])&&p(U,"src",C),p(U,"frameborder","0"),p(U,"allow","accelerometer; autoplay; encrypted-media; gyroscope;\n    picture-in-picture"),U.allowFullscreen=!0,p(M,"href",t[4]),p(M,"target","_blank")},m(e,s){a(e,n,s),r(n,i),r(i,l),r(n,o),r(n,d),r(d,w),r(d,f),r(f,g),r(d,y),r(d,b),r(n,v),r(n,L),r(n,R),r(n,$),r(n,k),r(n,U),t[8](U),r(n,x),r(n,T),r(T,M),r(M,H)},p(e,[t]){2&t&&m(l,e[1]),8&t&&p(f,"href",e[3]),32&t&&p(U,"width",e[5]),64&t&&p(U,"height",e[6]),4&t&&U.src!==(C=e[2])&&p(U,"src",C),16&t&&p(M,"href",e[4])},i:e,o:e,d(e){e&&s(n),t[8](null)}}}function N(e,t,n){let i,l,{title:o}=t,{gameWebURL:r}=t,{latestReleaseURL:a}=t,{githubSourceURL:s}=t,{iframe:c=null}=t,{windowWidth:h}=t;return g(()=>c.focus()),e.$set=e=>{"title"in e&&n(1,o=e.title),"gameWebURL"in e&&n(2,r=e.gameWebURL),"latestReleaseURL"in e&&n(3,a=e.latestReleaseURL),"githubSourceURL"in e&&n(4,s=e.githubSourceURL),"iframe"in e&&n(0,c=e.iframe),"windowWidth"in e&&n(7,h=e.windowWidth)},e.$$.update=()=>{128&e.$$.dirty&&n(5,i=Math.min(.66*h,560)),32&e.$$.dirty&&n(6,l=i)},[c,o,r,a,s,i,l,h,function(e){b[e?"unshift":"push"](()=>{n(0,c=e)})}]}class D extends A{constructor(e){super(),I(this,e,N,q,o,{title:1,gameWebURL:2,latestReleaseURL:3,githubSourceURL:4,iframe:0,windowWidth:7})}}function j(t){let n,i,l,o,d,w,f,g,y,b,v,L;return{c(){n=c("main"),i=c("h1"),l=h(t[1]),o=u(),d=c("p"),w=c("a"),f=h("Full Screen"),g=u(),y=c("span"),y.textContent="Recommended",b=u(),v=c("iframe"),p(w,"href",t[2]),p(w,"target","_blank"),p(y,"class","italic svelte-10b9e0n"),p(v,"title","game"),p(v,"class","center"),p(v,"width",t[3]),p(v,"height",t[4]),v.src!==(L=t[2])&&p(v,"src",L),p(v,"frameborder","0"),p(v,"allow","accelerometer; autoplay; encrypted-media; gyroscope;\n    picture-in-picture"),v.allowFullscreen=!0},m(e,s){a(e,n,s),r(n,i),r(i,l),r(n,o),r(n,d),r(d,w),r(w,f),r(d,g),r(d,y),r(n,b),r(n,v),t[7](v)},p(e,[t]){2&t&&m(l,e[1]),4&t&&p(w,"href",e[2]),8&t&&p(v,"width",e[3]),16&t&&p(v,"height",e[4]),4&t&&v.src!==(L=e[2])&&p(v,"src",L)},i:e,o:e,d(e){e&&s(n),t[7](null)}}}function B(e,t,n){let i,l,{title:o}=t,{editorURL:r}=t,{iframe:a=null}=t,{windowWidth:s}=t,{windowHeight:c}=t;return g(()=>a.focus()),e.$set=e=>{"title"in e&&n(1,o=e.title),"editorURL"in e&&n(2,r=e.editorURL),"iframe"in e&&n(0,a=e.iframe),"windowWidth"in e&&n(5,s=e.windowWidth),"windowHeight"in e&&n(6,c=e.windowHeight)},e.$$.update=()=>{32&e.$$.dirty&&n(3,i=.95*s),64&e.$$.dirty&&n(4,l=.8*c)},[a,o,r,i,l,s,c,function(e){b[e?"unshift":"push"](()=>{n(0,a=e)})}]}class V extends A{constructor(e){super(),I(this,e,B,j,o,{title:1,editorURL:2,iframe:0,windowWidth:5,windowHeight:6})}}function Y(t){let n,i,l,o,d,w,f,g,y,b,v,L,R;return{c(){n=c("main"),i=c("h1"),l=h(t[0]),o=u(),d=c("h2"),d.textContent="Watch live on Twitch",w=u(),f=c("div"),g=u(),y=c("a"),b=h("Twitch Channel"),v=h("\n  |\n  "),L=c("a"),R=h("YouTube Playlist"),p(f,"id","twitch-embed"),p(y,"href",t[1]),p(y,"target","_blank"),p(L,"href",t[2]),p(L,"target","_blank")},m(e,t){a(e,n,t),r(n,i),r(i,l),r(n,o),r(n,d),r(n,w),r(n,f),r(n,g),r(n,y),r(y,b),r(n,v),r(n,L),r(L,R)},p(e,[t]){1&t&&m(l,e[0]),2&t&&p(y,"href",e[1]),4&t&&p(L,"href",e[2])},i:e,o:e,d(e){e&&s(n)}}}function J(e,t,n){let i,l,o,{title:r}=t,{twitchChannelURL:a}=t,{twitchChannel:s}=t,{youtubePlaylistURL:c}=t,{windowWidth:h}=t;return g(()=>new window.Twitch.Embed("twitch-embed",{width:i,height:l,layout:o,channel:s})),e.$set=e=>{"title"in e&&n(0,r=e.title),"twitchChannelURL"in e&&n(1,a=e.twitchChannelURL),"twitchChannel"in e&&n(3,s=e.twitchChannel),"youtubePlaylistURL"in e&&n(2,c=e.youtubePlaylistURL),"windowWidth"in e&&n(4,h=e.windowWidth)},e.$$.update=()=>{16&e.$$.dirty&&n(5,i=Math.min(.66*h,1400)),32&e.$$.dirty&&(l=i/1.77),32&e.$$.dirty&&(o=i>900?"video-with-chat":"video")},[r,a,c,s,h]}class X extends A{constructor(e){super(),I(this,e,J,Y,o,{title:0,twitchChannelURL:1,twitchChannel:3,youtubePlaylistURL:2,windowWidth:4})}}function K(t){let n,i,l,o,d,m,w,f,g,y,b,v,L,R,$,k,U,C,x,T,M,H,W,_,P,S,G,z,I,A,O,E,F,q,N,D,j,B,V,Y,J,X,K,Q,Z,ee,te,ne,ie,le,oe,re,ae,se,ce,he,ue,de,pe,me,we,fe,ge,ye,be,ve,Le;return{c(){n=c("h1"),i=c("a"),l=h("Multiplayer Client-Server Architecture"),o=u(),d=c("p"),d.innerHTML="<code>Saturday, April 4, 2020</code>",m=u(),w=c("h2"),w.textContent="Terms",f=u(),g=c("h3"),g.textContent="Latency aka RTT aka Ping",y=u(),b=c("ul"),b.innerHTML="<li>round trip time is the time for a client message to result in a received server message</li> \n<li>the larger the RTT is, the larger is the latency</li>",v=u(),L=c("h4"),L.textContent="Jitter",R=u(),$=c("ul"),$.innerHTML="<li>the rate of change in the RTT</li>",k=u(),U=c("h3"),U.textContent="Authorative Server",C=u(),x=c("ul"),x.innerHTML="<li>game happens in server under our control</li> \n<li>clients just send inputs and render world as simulated by the server</li>",T=u(),M=c("h3"),M.textContent="Lockstep",H=u(),W=c("ul"),W.innerHTML="<li>client waits for server messages before updating or rendering anything</li> \n<li>used in Doom, worked well over LAN, but was unplayable over the internet</li>",_=u(),P=c("h2"),P.textContent="Server Time Step",S=u(),G=c("ul"),G.innerHTML="<li>goal is to decouple server updates from client command frequency</li> \n<li>queue player inputs without any processing (game loop does not run yet)</li> \n<li>instead game loop runs at much lower frequency i.e. every 100ms (time step)</li> \n<li>applies all queued player inputs<ul><li>to make physics more realistic they may be applied at smaller time deltas</li></ul></li> \n<li>then we take snapshot of resulting game state and broadcast to clients</li> \n<li>in order for client to successfully predict other entities in between updates it needs to\nhave sufficient info, in our game that means knowing the players + bullets velocity vectors</li>",z=u(),I=c("h3"),I.textContent="Prediction",A=u(),O=c("ul"),O.innerHTML='<li>predict local player and other entities from last given state<ul><li>in our game that means applying entity velocity onto last known entity\nposition considering time delta</li></ul></li> \n<li>when we get server state we&#39;ll <em>correct</em> our prediction</li> \n<li>best done via shared game simulation code<ul><li>in our game controller code is shared, so we are golden</li></ul></li> \n<li>the more deterministic our game is the better the result</li> \n<li>use message IDs to be able to replay commands that server hasn&#39;t received yet <a href="https://www.gabrielgambetta.com/client-side-prediction-server-reconciliation.html#server-reconciliation">see</a></li>',E=u(),F=c("h3"),F.textContent="Dead Reckoning",q=u(),N=c("ul"),N.innerHTML="<li>using client side prediction we may result in a slightly different game\nstate than server arrived at </li> \n<li>once we receive an update from the server and it doesn&#39;t match our state, we\ncorrect our assumptions</li> \n<li>falls down when game state is less predictable as that means we&#39;d correct\nour state all the time leading to lots of jumps, i.e. if player direction\nchanges frequently</li>",D=u(),j=c("h3"),j.textContent="Smoothing",B=u(),V=c("ul"),V.innerHTML="<li>correcting client position to position sent by server in one step may lead to jumps</li> \n<li>instead we can correct position slowly over time to make it look <em>smoother</em></li> \n<li>if interpolation work properly smoothing is not required as we know ahead of time where the\nentity will be</li>",Y=u(),J=c("h3"),J.textContent="Interpolation",X=u(),K=c("ul"),K.innerHTML="<li>on the client show all entities except the player we control in the past</li> \n<li>buffer server game state messages and replay positions of other players delayed<ul><li>usually two packets behind</li></ul></li> \n<li>as a result we see ourselves in the present but everyone else in the past</li> \n<li>as this adds more lag to the opponents it makes lag compensation more importantXC</li> \n<li>adds client complexity</li>",Q=u(),Z=c("h3"),Z.textContent="Lag Compensation",ee=u(),te=c("ul"),te.innerHTML="<li>due to network lag and interpolation we&#39;re aiming at opponent&#39;s past positions</li> \n<li>to fix the server does the following<ul><li>reconstructs the world as we saw it when we fired shot (takes step back in time)</li> \n<li>this means all entities are moved back to where they were in that past</li> \n<li>then processes our action and determines result of shot as it would have happened in the\npast</li> \n<li>then moves game state back to present and sends snapshot - note that if present state is affected by outcome of player action applied in the past that needs to be applied to that present game state</li></ul></li> \n<li>adds server complexity</li>",ne=u(),ie=c("h2"),ie.textContent="Resources",le=u(),oe=c("ul"),oe.innerHTML='<li><a href="https://www.gabrielgambetta.com/client-server-game-architecture.html">Fast-Paced Multiplayer four parts</a></li> \n<li><a href="https://www.gamasutra.com/blogs/MarkMennell/20140929/226628/Making_FastPaced_Multiplayer_Networked_Games_is_Hard.php">Making Fast-Paced Multiplayer Networked Games is Hard</a></li>',re=u(),ae=c("h3"),ae.textContent="Valve",se=u(),ce=c("ul"),ce.innerHTML='<li><a href="https://developer.valvesoftware.com/wiki/Prediction">Prediction</a></li> \n<li><a href="https://developer.valvesoftware.com/wiki/Interpolation">Interpolation</a></li> \n<li><a href="https://developer.valvesoftware.com/wiki/Lag_compensation">Lag Compensation</a></li> \n<li><a href="https://developer.valvesoftware.com/wiki/Latency_Compensating_Methods_in_Client/Server_In-game_Protocol_Design_and_Optimization">Interpolation / Latency\nCompensation</a></li> \n<li><a href="https://developer.valvesoftware.com/wiki/Source_Multiplayer_Networking">Source Multiplayer\nNetworking</a></li>',he=u(),ue=c("h3"),ue.textContent="IT Hare on Software",de=u(),pe=c("ul"),pe.innerHTML='<li><a href="http://ithare.com/chapter-ii-game-entities-and-interactions-from-upcoming-book-development-and-deployment-of-mmog/">Game Entities and Interactions</a></li> \n<li><a href="http://ithare.com/chapter-iii-on-cheating-p2p-and-non-authoritative-servers-from-dd-of-mmog-book/">On Cheating, P2P, and non-Authoritative Servers</a></li> \n<li><a href="Http://ithare.com/mmog-rtt-input-lag-and-how-to-mitigate-them/">MMOG. RTT, Input Lag, and How to Mitigate Them</a></li> \n<li><a href="http://ithare.com/mmog-world-states-and-reducing-traffic/">MMOG: World States and Reducing Traffic</a></li> \n<li><a href="http://ithare.com/mmog-point-to-point-communications-and-non-blocking-rpcs/">MMOG. Point-to-Point Communications and non-blocking RPCs</a></li>',me=u(),we=c("h3"),we.textContent="Gaffer On Games",fe=u(),ge=c("ul"),ge.innerHTML='<li><a href="https://gafferongames.com/post/deterministic_lockstep/">Deterministic Lockstep</a></li> \n<li><a href="https://gafferongames.com/post/state_synchronization/">State Synchronization</a></li> \n<li><a href="https://gafferongames.com/post/snapshot_interpolation/">Snapshot Interpolation</a></li>',ye=u(),be=c("h3"),be.textContent="Unreal",ve=u(),Le=c("ul"),Le.innerHTML='<li><a href="https://docs.unrealengine.com/udk/Three/NetworkingOverview.html">Unreal Engine 2: Unreal Networking\nArchitecture</a></li> \n<li><a href="https://docs.unrealengine.com/en-US/Gameplay/Networking/Overview/index.html">Unreal Engine 4: Networking Overview</a></li>',p(i,"href",t[0]),p(d,"class","right")},m(e,t){a(e,n,t),r(n,i),r(i,l),a(e,o,t),a(e,d,t),a(e,m,t),a(e,w,t),a(e,f,t),a(e,g,t),a(e,y,t),a(e,b,t),a(e,v,t),a(e,L,t),a(e,R,t),a(e,$,t),a(e,k,t),a(e,U,t),a(e,C,t),a(e,x,t),a(e,T,t),a(e,M,t),a(e,H,t),a(e,W,t),a(e,_,t),a(e,P,t),a(e,S,t),a(e,G,t),a(e,z,t),a(e,I,t),a(e,A,t),a(e,O,t),a(e,E,t),a(e,F,t),a(e,q,t),a(e,N,t),a(e,D,t),a(e,j,t),a(e,B,t),a(e,V,t),a(e,Y,t),a(e,J,t),a(e,X,t),a(e,K,t),a(e,Q,t),a(e,Z,t),a(e,ee,t),a(e,te,t),a(e,ne,t),a(e,ie,t),a(e,le,t),a(e,oe,t),a(e,re,t),a(e,ae,t),a(e,se,t),a(e,ce,t),a(e,he,t),a(e,ue,t),a(e,de,t),a(e,pe,t),a(e,me,t),a(e,we,t),a(e,fe,t),a(e,ge,t),a(e,ye,t),a(e,be,t),a(e,ve,t),a(e,Le,t)},p(e,[t]){1&t&&p(i,"href",e[0])},i:e,o:e,d(e){e&&s(n),e&&s(o),e&&s(d),e&&s(m),e&&s(w),e&&s(f),e&&s(g),e&&s(y),e&&s(b),e&&s(v),e&&s(L),e&&s(R),e&&s($),e&&s(k),e&&s(U),e&&s(C),e&&s(x),e&&s(T),e&&s(M),e&&s(H),e&&s(W),e&&s(_),e&&s(P),e&&s(S),e&&s(G),e&&s(z),e&&s(I),e&&s(A),e&&s(O),e&&s(E),e&&s(F),e&&s(q),e&&s(N),e&&s(D),e&&s(j),e&&s(B),e&&s(V),e&&s(Y),e&&s(J),e&&s(X),e&&s(K),e&&s(Q),e&&s(Z),e&&s(ee),e&&s(te),e&&s(ne),e&&s(ie),e&&s(le),e&&s(oe),e&&s(re),e&&s(ae),e&&s(se),e&&s(ce),e&&s(he),e&&s(ue),e&&s(de),e&&s(pe),e&&s(me),e&&s(we),e&&s(fe),e&&s(ge),e&&s(ye),e&&s(be),e&&s(ve),e&&s(Le)}}}function Q(e,t,n){let{link:i}=t;return e.$set=e=>{"link"in e&&n(0,i=e.link)},[i]}class Z extends A{constructor(e){super(),I(this,e,Q,K,o,{link:0})}}function ee(t){let n,i,l,o,d,m,w,f,g,y,b,v,L,R,$,k,U,C,x,T,M,H,W,_,P;return{c(){n=c("h1"),i=c("a"),l=h("Appling Multiplayer Strategies to Our Game"),o=u(),d=c("p"),d.innerHTML="<code>Saturday, April 4, 2020</code>",m=u(),w=c("h2"),w.textContent="Main Strategy Used",f=u(),g=c("ul"),g.innerHTML="<li>authoritative server sending updates every 100ms</li> \n<li>client updates are limited to 10/second</li> \n<li>client side prediction is used to exrapolate opponent&#39;s position from previous position and\ntheir velocity</li> \n<li>other players and bullets are predicted on the client from previous position and velocity<ul><li>same controllers as on server are used which allows us to predict collisions client side as\nwell</li></ul></li> \n<li>use dead reckoning to correct client predictions, both for opponents and bullets as well as\nour own player</li>",y=u(),b=c("h2"),b.textContent="Limiting Player Inputs",v=u(),L=c("ul"),L.innerHTML="<li>require 100ms between each shot<ul><li>instead of sending a key press we send <code>bulletCreated(angle)</code></li></ul></li> \n<li>require 100ms between each thrust<ul><li>instead of sending key press we send <code>appliedThrust(anger)</code></li> \n<li>server then calculates velocity</li></ul></li> \n<li>instead of sending rotation input we send <code>updatedAngle(angle)</code></li> \n<li>change of player angle happens in real time but is reported to the server at a 100ms interval\neven if no other client action occured</li>",R=u(),$=c("h2"),$.textContent="Server Processing of Player Inputs",k=u(),U=c("ul"),U.innerHTML="<li>delay execution of action until server tick<ul><li>in the worst case bullet is trailing client side prediction by 100ms</li></ul></li> \n<li>find way to align client input ticks to server ticks</li>",C=u(),x=c("h2"),x.textContent="To be seen",T=u(),M=c("ul"),M.innerHTML="<li>test how well dead reckoning works for our game and try the following if we end up with lots\nof player position jumps</li> \n<li>apply smooting to correct position slowly over time</li> \n<li>if nothing else works look into interpolation</li>",H=u(),W=c("h2"),W.textContent="Smaller Packets",_=u(),P=c("ul"),P.innerHTML="<li>if packets get too large we can omit bullet positions<ul><li>instead rely on client prediction to show bullets in flight</li> \n<li>use server to report created bullets <code>createBullet(bulletID, position, velocity)</code><ul><li>after that client predicts positions</li></ul></li> \n<li>and exploded bullets<ul><li><code>explodedBullet(bulletID, position)</code></li></ul></li></ul></li> \n<li>alternative is to limit amount of bullets / ammo available</li>",p(i,"href",t[0]),p(d,"class","right")},m(e,t){a(e,n,t),r(n,i),r(i,l),a(e,o,t),a(e,d,t),a(e,m,t),a(e,w,t),a(e,f,t),a(e,g,t),a(e,y,t),a(e,b,t),a(e,v,t),a(e,L,t),a(e,R,t),a(e,$,t),a(e,k,t),a(e,U,t),a(e,C,t),a(e,x,t),a(e,T,t),a(e,M,t),a(e,H,t),a(e,W,t),a(e,_,t),a(e,P,t)},p(e,[t]){1&t&&p(i,"href",e[0])},i:e,o:e,d(e){e&&s(n),e&&s(o),e&&s(d),e&&s(m),e&&s(w),e&&s(f),e&&s(g),e&&s(y),e&&s(b),e&&s(v),e&&s(L),e&&s(R),e&&s($),e&&s(k),e&&s(U),e&&s(C),e&&s(x),e&&s(T),e&&s(M),e&&s(H),e&&s(W),e&&s(_),e&&s(P)}}}function te(e,t,n){let{link:i}=t;return e.$set=e=>{"link"in e&&n(0,i=e.link)},[i]}class ne extends A{constructor(e){super(),I(this,e,te,ee,o,{link:0})}}function ie(t){let n,i,l,o,d,m,w,f,g,y,b,v,L,R,$,k,U,C,x,T,M,H,W,_,P,S,G,z,I,A,O,E;return{c(){n=c("h1"),i=c("a"),l=h("What's left to go to "),o=c("em"),o.textContent='"Production"',d=u(),m=c("p"),m.innerHTML="<code>Friday, May 8, 2020</code>",w=u(),f=c("p"),f.textContent="The game is basically finished at this point. We demonstrated that it is possible to build\nMultiplayer games like this with Flutter.",g=u(),y=c("p"),y.textContent="We also learned that making the server authoritative adds a lot of complexity. Not that it\nisn't solvable, but not worrying about cheaters makes the life of us developers a lot easier ;)",b=u(),v=c("p"),v.innerHTML="Below I&#39;m listing known issues that would need to be considered/fixed before the game as is\nwould be ready to go to <em>&quot;production&quot;</em> to be played by people all over the world.",L=u(),R=c("p"),R.textContent="The video series doesn't include these fixes as it ends here as its purpose was merely to get\npeople excited about building games in general and to demonstrate that Flutter is a viable and\nalso fun technology to do so.",$=u(),k=c("p"),k.textContent="If you're inspired you may continue building the game or build your own.",U=u(),C=c("p"),C.textContent="If you do the former you can start attacking issues listed below and/or refactor the code to\nnot require an authoritative server and get an idea how much easier things become as a result.",x=u(),T=c("p"),T.textContent="Happy Hacking!",M=u(),H=c("h2"),H.textContent="Client Side",W=u(),_=c("ul"),_.innerHTML='<li><p>sync player position smoothly</p> \n<ul><li>when position differs from server sent position don&#39;t jump to it immediately</li> \n<li>instead adjust players velocity so that it converges towards the server position</li> \n<li>over time server and client positions should either sync up or at least they don&#39;t go\nfurther out of sync event though we don&#39;t force correct with a jump</li></ul></li> \n<li><p>client networking</p> \n<ul><li>when client disconnects i.e. I&#39;m in a tunnel it needs to be able to reconnect</li> \n<li>this requires some logic to detect disconnects and have a reconnect strategy, i.e. <a href="https://en.wikipedia.org/wiki/Circuit_breaker_design_pattern">circuit breaker</a> to prevent it trying to reconnect indefinitely</li> \n<li>if reconnection fails tell the client that game is over or similar</li></ul></li>',P=u(),S=c("h2"),S.textContent="Server Side",G=u(),z=c("ul"),z.innerHTML="<li><p>Clean up Games</p> \n<ul><li>as of now games that finished never get collected</li> \n<li>first we need a way to detect if a game is over<ul><li>when only one player is alive</li> \n<li>it is nice to show player still floating around even when game is over</li> \n<li>how long do we give all players to restart game before we collect it</li> \n<li>what if all players disconnect?</li> \n<li>how long can a player be disconnected until it is disqualified and declared dead?</li></ul></li></ul></li> \n<li><p>Server needs to handle client reconnecting</p> \n<ul><li>when client provides game + client ids we reconnect the update streams</li></ul></li> \n<li><p>Make Server resilient</p> \n<ul><li>what happens if server crashes?</li> \n<li>need to have a way to detect that and have it restarted</li> \n<li>this can be handled by tools like systemd or load balancers</li></ul></li> \n<li><p>How do sticky sessions work when we have multiple servers</p> \n<ul><li>only need to fix this once we have certain success and lots of concurrent players</li> \n<li>once we have multiple servers need to figure out how to propagate RPC streams</li> \n<li>which load balancers support those + http2</li></ul></li> \n<li><p>deploy server(s)</p> \n<ul><li>where can we deploy dart servers?</li></ul></li>",I=u(),A=c("h2"),A.textContent="Added Features",O=u(),E=c("ul"),E.innerHTML="<li><p>Pickups</p> \n<ul><li>have health packets to allow players to pickup and increase their health balance</li> \n<li>other pickups could increase player score</li></ul></li> \n<li><p>Black Holes</p> \n<ul><li>draw players in to make things more interesting</li></ul></li> \n<li><p>Visualize Thrust + Bullet State</p> \n<ul><li>players can only apply thrust and shoot at certain intervals</li> \n<li>it would be nice to visualize the time left until we can do either</li> \n<li>it could look similar to the health bar</li></ul></li>",p(i,"href",t[0]),p(m,"class","right")},m(e,t){a(e,n,t),r(n,i),r(i,l),r(i,o),a(e,d,t),a(e,m,t),a(e,w,t),a(e,f,t),a(e,g,t),a(e,y,t),a(e,b,t),a(e,v,t),a(e,L,t),a(e,R,t),a(e,$,t),a(e,k,t),a(e,U,t),a(e,C,t),a(e,x,t),a(e,T,t),a(e,M,t),a(e,H,t),a(e,W,t),a(e,_,t),a(e,P,t),a(e,S,t),a(e,G,t),a(e,z,t),a(e,I,t),a(e,A,t),a(e,O,t),a(e,E,t)},p(e,[t]){1&t&&p(i,"href",e[0])},i:e,o:e,d(e){e&&s(n),e&&s(d),e&&s(m),e&&s(w),e&&s(f),e&&s(g),e&&s(y),e&&s(b),e&&s(v),e&&s(L),e&&s(R),e&&s($),e&&s(k),e&&s(U),e&&s(C),e&&s(x),e&&s(T),e&&s(M),e&&s(H),e&&s(W),e&&s(_),e&&s(P),e&&s(S),e&&s(G),e&&s(z),e&&s(I),e&&s(A),e&&s(O),e&&s(E)}}}function le(e,t,n){let{link:i}=t;return e.$set=e=>{"link"in e&&n(0,i=e.link)},[i]}class oe extends A{constructor(e){super(),I(this,e,le,ie,o,{link:0})}}function re(t){let n,i,l,o,h,d,m,w,f;const g=new oe({props:{link:"#"+ce}}),y=new ne({props:{link:"#"+ae}}),b=new Z({props:{link:"#"+se}});return{c(){n=c("main"),i=c("article"),P(g.$$.fragment),l=u(),o=c("article"),P(y.$$.fragment),h=u(),d=c("p"),m=u(),w=c("article"),P(b.$$.fragment),p(i,"id",ce),p(i,"class","svelte-12amb70"),p(o,"id",ae),p(o,"class","svelte-12amb70"),p(d,"class","separator svelte-12amb70"),p(w,"id",se),p(w,"class","svelte-12amb70")},m(e,t){a(e,n,t),r(n,i),S(g,i,null),r(n,l),r(n,o),S(y,o,null),r(n,h),r(n,d),r(n,m),r(n,w),S(b,w,null),f=!0},p:e,i(e){f||(W(g.$$.fragment,e),W(y.$$.fragment,e),W(b.$$.fragment,e),f=!0)},o(e){_(g.$$.fragment,e),_(y.$$.fragment,e),_(b.$$.fragment,e),f=!1},d(e){e&&s(n),G(g),G(y),G(b)}}}const ae="devlog-applying-strategies",se="devlog-multiplayer-architecture",ce="devlog-batufo-todos";class he extends A{constructor(e){super(),I(this,e,null,re,o,{})}}function ue(t){let n;const i=new he({});return{c(){P(i.$$.fragment)},m(e,t){S(i,e,t),n=!0},p:e,i(e){n||(W(i.$$.fragment,e),n=!0)},o(e){_(i.$$.fragment,e),n=!1},d(e){G(i,e)}}}function de(e){let t;const n=new X({props:{title:e[1],twitchChannelURL:e[7],twitchChannel:e[6],youtubePlaylistURL:e[10],windowWidth:e[19]}});return{c(){P(n.$$.fragment)},m(e,i){S(n,e,i),t=!0},p(e,t){const i={};2&t&&(i.title=e[1]),128&t&&(i.twitchChannelURL=e[7]),64&t&&(i.twitchChannel=e[6]),1024&t&&(i.youtubePlaylistURL=e[10]),524288&t&&(i.windowWidth=e[19]),n.$set(i)},i(e){t||(W(n.$$.fragment,e),t=!0)},o(e){_(n.$$.fragment,e),t=!1},d(e){G(n,e)}}}function pe(e){let t;const n=new V({props:{title:e[1],editorURL:e[5],windowWidth:e[19],windowHeight:e[20]}});return{c(){P(n.$$.fragment)},m(e,i){S(n,e,i),t=!0},p(e,t){const i={};2&t&&(i.title=e[1]),32&t&&(i.editorURL=e[5]),524288&t&&(i.windowWidth=e[19]),1048576&t&&(i.windowHeight=e[20]),n.$set(i)},i(e){t||(W(n.$$.fragment,e),t=!0)},o(e){_(n.$$.fragment,e),t=!1},d(e){G(n,e)}}}function me(e){let t;const n=new D({props:{title:e[1],gameWebURL:e[4],latestReleaseURL:e[8],githubSourceURL:e[13],windowWidth:e[19]}});return{c(){P(n.$$.fragment)},m(e,i){S(n,e,i),t=!0},p(e,t){const i={};2&t&&(i.title=e[1]),16&t&&(i.gameWebURL=e[4]),256&t&&(i.latestReleaseURL=e[8]),8192&t&&(i.githubSourceURL=e[13]),524288&t&&(i.windowWidth=e[19]),n.$set(i)},i(e){t||(W(n.$$.fragment,e),t=!0)},o(e){_(n.$$.fragment,e),t=!1},d(e){G(n,e)}}}function we(e){let t;const n=new F({props:{title:e[1],embedPlaylist:e[2],subChannelURL:e[3],gameWebURL:e[4],twitterURL:e[9],twitchChannelURL:e[7],latestReleaseURL:e[8],windowWidth:e[19]}});return{c(){P(n.$$.fragment)},m(e,i){S(n,e,i),t=!0},p(e,t){const i={};2&t&&(i.title=e[1]),4&t&&(i.embedPlaylist=e[2]),8&t&&(i.subChannelURL=e[3]),16&t&&(i.gameWebURL=e[4]),512&t&&(i.twitterURL=e[9]),128&t&&(i.twitchChannelURL=e[7]),256&t&&(i.latestReleaseURL=e[8]),524288&t&&(i.windowWidth=e[19]),n.$set(i)},i(e){t||(W(n.$$.fragment,e),t=!0)},o(e){_(n.$$.fragment,e),t=!1},d(e){G(n,e)}}}function fe(e){let t,n,l,o,m,w,f,g,y,b,v,L,R,$,k,U,C,x,T,M,P,S,G,z,I,A,O,E;const F=[we,me,pe,de,ue],q=[];function N(e,t){return e[0].currentRoute===e[11].home?0:e[0].currentRoute===e[11].game?1:e[0].currentRoute===e[11].editor?2:e[0].currentRoute===e[11].watch?3:(2049&t&&(z=!(e[0].currentRoute!==e[11].devlog&&!e[26]())),z?4:-1)}return~(I=N(e,-1))&&(A=q[I]=F[I](e)),{c(){t=c("main"),n=c("nav"),l=c("a"),o=h("Home"),w=u(),f=c("a"),g=h("Game"),b=u(),v=c("a"),L=h("Watch"),$=u(),k=c("a"),U=h("Devlog"),x=u(),T=c("a"),M=h("Editor"),S=u(),G=c("div"),A&&A.c(),p(l,"href",m=e[12]+e[11].home.hash),p(l,"class",e[14]),p(f,"href",y=e[12]+e[11].game.hash),p(f,"class",e[15]),p(v,"href",R=e[12]+e[11].watch.hash),p(v,"class",e[17]),p(k,"href",C=e[12]+e[11].devlog.hash),p(k,"class",e[18]),p(T,"href",P=e[12]+e[11].editor.hash),p(T,"class",e[16]),p(n,"class","svelte-1719mcr")},m(s,c,h){a(s,t,c),r(t,n),r(n,l),r(l,o),r(n,w),r(n,f),r(f,g),r(n,b),r(n,v),r(v,L),r(n,$),r(n,k),r(k,U),r(n,x),r(n,T),r(T,M),r(t,S),r(t,G),~I&&q[I].m(G,null),O=!0,h&&i(E),E=[d(l,"click",e[21]),d(f,"click",e[22]),d(v,"click",e[24]),d(k,"click",e[25]),d(T,"click",e[23])]},p(e,[t]){(!O||6144&t&&m!==(m=e[12]+e[11].home.hash))&&p(l,"href",m),(!O||16384&t)&&p(l,"class",e[14]),(!O||6144&t&&y!==(y=e[12]+e[11].game.hash))&&p(f,"href",y),(!O||32768&t)&&p(f,"class",e[15]),(!O||6144&t&&R!==(R=e[12]+e[11].watch.hash))&&p(v,"href",R),(!O||131072&t)&&p(v,"class",e[17]),(!O||6144&t&&C!==(C=e[12]+e[11].devlog.hash))&&p(k,"href",C),(!O||262144&t)&&p(k,"class",e[18]),(!O||6144&t&&P!==(P=e[12]+e[11].editor.hash))&&p(T,"href",P),(!O||65536&t)&&p(T,"class",e[16]);let n=I;I=N(e,t),I===n?~I&&q[I].p(e,t):(A&&(H={r:0,c:[],p:H},_(q[n],1,1,()=>{q[n]=null}),H.r||i(H.c),H=H.p),~I?(A=q[I],A||(A=q[I]=F[I](e),A.c()),W(A,1),A.m(G,null)):A=null)},i(e){O||(W(A),O=!0)},o(e){_(A),O=!1},d(e){e&&s(t),~I&&q[I].d(),i(E)}}}function ge(e,t,n){let{title:i}=t,{embedPlaylist:l}=t,{subChannelURL:o}=t,{gameWebURL:r}=t,{editorURL:a}=t,{twitchChannel:s}=t,{twitchChannelURL:c}=t,{latestReleaseURL:h}=t,{twitterURL:u}=t,{youtubePlaylistURL:d}=t,{state:p}=t,{routes:m}=t,{rootURL:w}=t,{githubSourceURL:f}=t;const g=()=>window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,y=()=>window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,b=()=>location.hash.startsWith(m.devlog.hash);let v,L,R,$,k,U,C;return window.onresize=()=>{n(19,U=g()),n(20,C=y())},e.$set=e=>{"title"in e&&n(1,i=e.title),"embedPlaylist"in e&&n(2,l=e.embedPlaylist),"subChannelURL"in e&&n(3,o=e.subChannelURL),"gameWebURL"in e&&n(4,r=e.gameWebURL),"editorURL"in e&&n(5,a=e.editorURL),"twitchChannel"in e&&n(6,s=e.twitchChannel),"twitchChannelURL"in e&&n(7,c=e.twitchChannelURL),"latestReleaseURL"in e&&n(8,h=e.latestReleaseURL),"twitterURL"in e&&n(9,u=e.twitterURL),"youtubePlaylistURL"in e&&n(10,d=e.youtubePlaylistURL),"state"in e&&n(0,p=e.state),"routes"in e&&n(11,m=e.routes),"rootURL"in e&&n(12,w=e.rootURL),"githubSourceURL"in e&&n(13,f=e.githubSourceURL)},e.$$.update=()=>{2049&e.$$.dirty&&n(14,v=p.currentRoute===m.home?"underline":""),2049&e.$$.dirty&&n(15,L=p.currentRoute===m.game?"underline":""),2049&e.$$.dirty&&n(16,R=p.currentRoute===m.editor?"underline":""),2049&e.$$.dirty&&n(17,$=p.currentRoute===m.watch?"underline":"")},n(18,k=b()?"underline":""),n(19,U=g()),n(20,C=y()),[p,i,l,o,r,a,s,c,h,u,d,m,w,f,v,L,R,$,k,U,C,()=>{n(0,p.currentRoute=m.home,p),n(0,p)},()=>{n(0,p.currentRoute=m.game,p),n(0,p)},()=>{n(0,p.currentRoute=m.editor,p),n(0,p)},()=>{n(0,p.currentRoute=m.watch,p),n(0,p)},()=>{n(0,p.currentRoute=m.devlog,p),n(0,p)},b]}var ye={version:"v0.0.7",url:"https://github.com/thlorenz/batufo/releases/tag/v0.0.7"};const be={home:{id:"home",hash:""},game:{id:"game",hash:"#game"},editor:{id:"editor",hash:"#editor"},watch:{id:"watch",hash:"#watch"},devlog:{id:"devlog",hash:"#devlog"}},ve=location.hash,Le=ve===be.game.hash?be.game:ve===be.editor.hash?be.editor:ve===be.watch.hash?be.watch:location.hash.startsWith(be.devlog.hash)?be.devlog:be.home,Re=location.href.includes("localhost")?"/":"https://thlorenz.github.io/batufo/";return new class extends A{constructor(e){super(),I(this,e,ge,fe,o,{title:1,embedPlaylist:2,subChannelURL:3,gameWebURL:4,editorURL:5,twitchChannel:6,twitchChannelURL:7,latestReleaseURL:8,twitterURL:9,youtubePlaylistURL:10,state:0,routes:11,rootURL:12,githubSourceURL:13})}}({target:document.body,props:{title:"2D Multiplayer Flutter Game",embedVideo:"https://www.youtube.com/embed/xTcO6lPMUaA",embedPlaylist:"https://www.youtube.com/embed/videoseries?list=PL4k64WemroGlTDHJzVo_O1l6C0nuwRc6G",subChannelURL:"https://www.youtube.com/user/thlorenz10?sub_confirmation=1",gameWebURL:"https://thlorenz.github.io/batufo/webgame",editorURL:"https://thlorenz.github.io/batufo/editor",latestReleaseURL:ye.url,githubSourceURL:"https://github.com/thlorenz/batufo",youtubePlaylistURL:"https://www.youtube.com/watch?list=PL4k64WemroGlTDHJzVo_O1l6C0nuwRc6G&v=xTcO6lPMUaA",twitchChannel:"thlorenz",twitchChannelURL:"https://www.twitch.tv/thlorenz",twitterURL:"https://twitter.com/thlorenz",routes:be,state:{currentRoute:Le},rootURL:Re}})}();
//# sourceMappingURL=bundle.js.map
